/* browser-console v1.0.0 | MIT License | https://github.com/ProfPowell/browser-console */
class BrowserConsole extends HTMLElement{constructor(){super();this.attachShadow({mode:'open'});this.logs=[];this.originalConsole={};this.filter=null;this.maxLogs=1000;this.timers={};this.theme='dark';this.render();}connectedCallback(){const autoHook=this.getAttribute('auto-hook')!=='false';const theme=this.getAttribute('theme')|| 'dark';this.theme=theme;if(autoHook){this.hookConsole();}this.updateTheme();}static get observedAttributes(){return ['theme'];}attributeChangedCallback(name,oldValue,newValue){if(name==='theme' && oldValue !==newValue){this.theme=newValue || 'dark';this.updateTheme();}}updateTheme(){const feed=this.shadowRoot.querySelector('.console-feed');if(feed){feed.dataset.theme=this.theme;}}setTheme(theme){this.theme=theme;this.setAttribute('theme',theme);}disconnectedCallback(){this.unhookConsole();}hookConsole(){const methods=['log','info','warn','error','debug','table','clear','time','timeEnd','count','assert'];methods.forEach(method=>{this.originalConsole[method]=console[method];console[method]=(...args)=>{this.originalConsole[method]?.apply(console,args);if(method==='time'){const label=args[0] || 'default';this.timers[label]=performance.now();return;}if(method==='timeEnd'){const label=args[0] || 'default';if(this.timers[label] !==undefined){const duration=performance.now()- this.timers[label];delete this.timers[label];this.addLog({method:'time',data:[label,duration],timestamp:new Date()});}return;}this.addLog({method,data:args,timestamp:new Date()});};});}unhookConsole(){Object.keys(this.originalConsole).forEach(method=>{console[method]=this.originalConsole[method];});this.originalConsole={};}addLog(log){if(log.method==='clear'){this.clearLogs();return;}this.logs.push(log);if(this.logs.length > this.maxLogs){this.logs.shift();}this.renderLogs();}clearLogs(){this.logs=[];this.renderLogs();}setFilter(filter){this.filter=filter;this.renderLogs();}render(){this.shadowRoot.innerHTML=`<style>${this.getStyles()}</style><div class="console-feed" data-theme="${this.theme}"><div class="console-header"><div class="console-filters"><button class="filter-btn active" data-filter="all">All</button><button class="filter-btn" data-filter="log">Log</button><button class="filter-btn" data-filter="info">Info</button><button class="filter-btn" data-filter="warn">Warn</button><button class="filter-btn" data-filter="error">Error</button></div><div class="console-actions"><button class="theme-btn" title="Toggle theme"><span class="theme-icon">☀️</span></button><button class="clear-btn">Clear</button></div></div><div class="console-logs"></div></div>`;this.shadowRoot.querySelector('.clear-btn').addEventListener('click',()=>this.clearLogs());this.shadowRoot.querySelector('.theme-btn').addEventListener('click',()=>{this.setTheme(this.theme==='dark' ? 'light':'dark');});this.shadowRoot.querySelectorAll('.filter-btn').forEach(btn=>{btn.addEventListener('click',(e)=>{this.shadowRoot.querySelectorAll('.filter-btn').forEach(b=>b.classList.remove('active'));e.target.classList.add('active');const filter=e.target.dataset.filter;this.setFilter(filter==='all' ? null:filter);});});}renderLogs(){const logsContainer=this.shadowRoot.querySelector('.console-logs');const filteredLogs=this.filter? this.logs.filter(log=>log.method===this.filter):this.logs;logsContainer.innerHTML=filteredLogs.map((log,index)=>this.renderLog(log,index)).join('');this.attachLogListeners();}renderLog(log,index){const timestamp=this.formatTimestamp(log.timestamp);const methodClass=`log-${log.method}`;if(log.method==='table'){const tableHtml=this.formatTable(log.data[0]);return `<div class="log-entry ${methodClass}" data-index="${index}"><span class="log-timestamp">${timestamp}</span><span class="log-method">[TABLE]</span><div class="log-content">${tableHtml}</div></div>`;}if(log.method==='time' && log.data.length===2){const [label,duration]=log.data;return `<div class="log-entry ${methodClass}" data-index="${index}"><span class="log-timestamp">${timestamp}</span><span class="log-method">[TIMER]</span><span class="log-content"><span class="value-string">${this.escapeHtml(label)}</span>:<span class="value-number">${duration.toFixed(2)}ms</span></span></div>`;}return `<div class="log-entry ${methodClass}" data-index="${index}"><span class="log-timestamp">${timestamp}</span><span class="log-method">[${log.method.toUpperCase()}]</span><span class="log-content">${this.formatLogData(log.data,log.method)}</span></div>`;}formatTimestamp(date){return date.toLocaleTimeString('en-US',{hour12:false,hour:'2-digit',minute:'2-digit',second:'2-digit',fractionalSecondDigits:3});}formatLogData(data,method){return data.map(item=>this.formatValue(item,0,false)).join(' ');}formatTable(data){if(!data){return '<span class="value-undefined">undefined</span>';}if(Array.isArray(data)&& data.length > 0){const isObjectArray=data.every(item=>typeof item==='object' && item !==null);if(isObjectArray){const keys=[...new Set(data.flatMap(obj=>Object.keys(obj)))];return `<div class="table-wrapper"><table class="console-table"><thead><tr><th>(index)</th>${keys.map(key=>`<th>${this.escapeHtml(key)}</th>`).join('')}</tr></thead><tbody>${data.map((row,index)=>`<tr><td class="table-index">${index}</td>${keys.map(key=>`<td>${this.formatValue(row[key],0,false)}</td>`).join('')}</tr>`).join('')}</tbody></table></div>`;}return `<div class="table-wrapper"><table class="console-table"><thead><tr><th>(index)</th><th>Value</th></tr></thead><tbody>${data.map((value,index)=>`<tr><td class="table-index">${index}</td><td>${this.formatValue(value,0,false)}</td></tr>`).join('')}</tbody></table></div>`;}if(typeof data==='object' && data !==null){const keys=Object.keys(data);return `<div class="table-wrapper"><table class="console-table"><thead><tr><th>(index)</th><th>Value</th></tr></thead><tbody>${keys.map(key=>`<tr><td class="table-index">${this.escapeHtml(key)}</td><td>${this.formatValue(data[key],0,false)}</td></tr>`).join('')}</tbody></table></div>`;}return this.formatValue(data,0,false);}formatValue(value,depth=0,expanded=false){const type=this.getType(value);switch(type){case 'string':return `<span class="value-string">"${this.escapeHtml(value)}"</span>`;case 'number':return `<span class="value-number">${value}</span>`;case 'boolean':return `<span class="value-boolean">${value}</span>`;case 'null':return `<span class="value-null">null</span>`;case 'undefined':return `<span class="value-undefined">undefined</span>`;case 'function':const fnStr=value.toString();const fnPreview=fnStr.length > 50 ? fnStr.substring(0,50)+ '...':fnStr;return `<span class="value-function">${this.escapeHtml(fnPreview)}</span>`;case 'array':if(depth > 2){return `<span class="value-array">[Array(${value.length})]</span>`;}return this.formatArray(value,depth,expanded);case 'object':if(value instanceof Error){return `<span class="value-error">${this.escapeHtml(value.toString())}</span>`;}if(value instanceof Date){return `<span class="value-date">${value.toISOString()}</span>`;}if(value instanceof RegExp){return `<span class="value-regexp">${this.escapeHtml(value.toString())}</span>`;}if(depth > 2){return `<span class="value-object">{Object}</span>`;}return this.formatObject(value,depth,expanded);case 'element':return this.formatElement(value);default:return `<span class="value-default">${this.escapeHtml(String(value))}</span>`;}}formatArray(arr,depth,expanded){if(arr.length===0){return `<span class="value-array">[]</span>`;}const id='arr_' + Math.random().toString(36).substr(2,9);const preview=arr.slice(0,3).map(item=>this.formatValue(item,depth + 1,false)).join(',');const suffix=arr.length > 3 ? `,... ${arr.length - 3}more`:'';const fullContent=arr.map((item,index)=>{const value=this.formatValue(item,depth + 1,false);return `<div class="object-property"><span class="property-key">${index}:</span><span class="property-value">${value}</span></div>`;}).join('');return `<div class="expandable-container"><span class="expandable-header" data-target="${id}"><span class="expand-icon">▶</span><span class="value-array"><span class="type-label">Array(${arr.length})</span> [${preview}${suffix}]</span></span><div class="expandable-content" id="${id}" style="display:none;">${fullContent}</div></div>`;}formatObject(obj,depth,expanded){const keys=Object.keys(obj);if(keys.length===0){return `<span class="value-object">{}</span>`;}const id='obj_' + Math.random().toString(36).substr(2,9);const preview=keys.slice(0,3).map(key=>{const value=this.formatValue(obj[key],depth + 1,false);return `${key}:${value}`;}).join(',');const suffix=keys.length > 3 ? `,... ${keys.length - 3}more`:'';const fullContent=keys.map(key=>{const value=this.formatValue(obj[key],depth + 1,false);return `<div class="object-property"><span class="property-key">${this.escapeHtml(key)}:</span><span class="property-value">${value}</span></div>`;}).join('');const constructorName=obj.constructor?.name || 'Object';return `<div class="expandable-container"><span class="expandable-header" data-target="${id}"><span class="expand-icon">▶</span><span class="value-object"><span class="type-label">${constructorName}</span>{${preview}${suffix}}</span></span><div class="expandable-content" id="${id}" style="display:none;">${fullContent}</div></div>`;}formatElement(element){const tagName=element.tagName.toLowerCase();const id=element.id ? `#${element.id}`:'';const classes=element.className ? `.${element.className.split(' ').join('.')}`:'';return `<span class="value-element">&lt;${tagName}${id}${classes}&gt;</span>`;}getType(value){if(value===null)return 'null';if(value===undefined)return 'undefined';if(Array.isArray(value))return 'array';if(value instanceof HTMLElement)return 'element';return typeof value;}escapeHtml(text){const div=document.createElement('div');div.textContent=text;return div.innerHTML;}attachLogListeners(){this.shadowRoot.querySelectorAll('.expandable-header').forEach(header=>{header.addEventListener('click',(e)=>{e.stopPropagation();const targetId=header.dataset.target;const content=this.shadowRoot.getElementById(targetId);const icon=header.querySelector('.expand-icon');if(content){const isExpanded=content.style.display !=='none';if(isExpanded){content.style.display='none';if(icon)icon.textContent='▶';}else{content.style.display='block';if(icon)icon.textContent='▼';}}});});}getStyles(){return `:host{display:block;font-family:'Consolas','Monaco','Courier New',monospace;font-size:12px;height:100%;}.console-feed[data-theme="dark"]{--bg-primary:#1e1e1e;--bg-secondary:#252526;--bg-tertiary:#2a2a2a;--bg-hover:#2a2a2a;--border-color:#3e3e42;--text-primary:#d4d4d4;--text-secondary:#6a6a6a;--color-log:#3794ff;--color-info:#75beff;--color-warn:#ffcc00;--color-error:#f48771;--color-debug:#b267e6;--color-table:#4ec9b0;--color-time:#4ec9b0;--bg-warn:#332b00;--bg-error:#342020;--value-string:#ce9178;--value-number:#b5cea8;--value-boolean:#569cd6;--value-null:#6a6a6a;--value-function:#dcdcaa;--value-date:#4fc1ff;--value-regexp:#d16969;--value-element:#4ec9b0;--btn-bg:#3e3e42;--btn-border:#555;--btn-hover:#505050;--btn-active:#0e639c;--table-border:#3e3e42;--table-header-bg:#2d2d30;--table-row-hover:#2a2a2a;--scrollbar-track:#1e1e1e;--scrollbar-thumb:#424242;--scrollbar-thumb-hover:#4e4e4e;}.console-feed[data-theme="light"]{--bg-primary:#ffffff;--bg-secondary:#f3f3f3;--bg-tertiary:#f8f8f8;--bg-hover:#f0f0f0;--border-color:#e0e0e0;--text-primary:#333333;--text-secondary:#999999;--color-log:#0066cc;--color-info:#0078d4;--color-warn:#ff8c00;--color-error:#e81123;--color-debug:#8b5cf6;--color-table:#00a67e;--color-time:#00a67e;--bg-warn:#fff9e6;--bg-error:#ffe6e6;--value-string:#a31515;--value-number:#098658;--value-boolean:#0000ff;--value-null:#999999;--value-function:#795e26;--value-date:#0078d4;--value-regexp:#e81123;--value-element:#00a67e;--btn-bg:#e8e8e8;--btn-border:#cccccc;--btn-hover:#d8d8d8;--btn-active:#0066cc;--table-border:#e0e0e0;--table-header-bg:#f3f3f3;--table-row-hover:#f8f8f8;--scrollbar-track:#f0f0f0;--scrollbar-thumb:#c0c0c0;--scrollbar-thumb-hover:#a0a0a0;}.console-feed{display:flex;flex-direction:column;height:100%;background:var(--bg-primary);color:var(--text-primary);transition:background 0.2s,color 0.2s;}.console-header{display:flex;justify-content:space-between;align-items:center;padding:8px;background:var(--bg-secondary);border-bottom:1px solid var(--border-color);}.console-filters{display:flex;gap:4px;}.console-actions{display:flex;gap:4px;align-items:center;}.filter-btn,.clear-btn,.theme-btn{padding:4px 12px;background:var(--btn-bg);color:var(--text-primary);border:1px solid var(--btn-border);border-radius:3px;cursor:pointer;font-size:11px;font-family:inherit;transition:background 0.2s;}.theme-btn{padding:4px 8px;font-size:14px;}.filter-btn:hover,.clear-btn:hover,.theme-btn:hover{background:var(--btn-hover);}.filter-btn.active{background:var(--btn-active);border-color:var(--btn-active);color:white;}.console-logs{flex:1;overflow-y:auto;padding:4px;}.log-entry{padding:2px 4px;margin:1px 0;display:flex;gap:8px;align-items:flex-start;border-left:3px solid transparent;}.log-entry:hover{background:var(--bg-hover);}.log-timestamp{color:var(--text-secondary);font-size:10px;white-space:nowrap;}.log-method{font-weight:bold;white-space:nowrap;min-width:60px;}.log-content{flex:1;word-break:break-word;}.log-log{border-left-color:var(--color-log);}.log-log .log-method{color:var(--color-log);}.log-info{border-left-color:var(--color-info);}.log-info .log-method{color:var(--color-info);}.log-warn{border-left-color:var(--color-warn);background:var(--bg-warn);}.log-warn .log-method{color:var(--color-warn);}.log-error{border-left-color:var(--color-error);background:var(--bg-error);}.log-error .log-method{color:var(--color-error);}.log-debug{border-left-color:var(--color-debug);}.log-debug .log-method{color:var(--color-debug);}.log-table{border-left-color:var(--color-table);}.log-table .log-method{color:var(--color-table);}.log-time{border-left-color:var(--color-time);}.log-time .log-method{color:var(--color-time);}.value-string{color:var(--value-string);}.value-number{color:var(--value-number);}.value-boolean{color:var(--value-boolean);}.value-null,.value-undefined{color:var(--value-null);font-style:italic;}.value-function{color:var(--value-function);}.value-array,.value-object{color:var(--text-primary);}.value-error{color:var(--color-error);}.value-date{color:var(--value-date);}.value-regexp{color:var(--value-regexp);}.value-element{color:var(--value-element);}.expandable-container{display:inline-block;}.expandable-header{cursor:pointer;user-select:none;}.expandable-header:hover{opacity:0.8;}.expand-icon{display:inline-block;width:12px;color:var(--text-secondary);font-size:10px;transition:transform 0.1s;}.expandable-content{padding-left:20px;margin-top:4px;}.object-property{padding:2px 0;line-height:1.4;}.property-key{color:var(--color-log);margin-right:8px;}.property-value{color:var(--text-primary);}.type-label{color:var(--text-secondary);font-style:italic;margin-right:4px;}.table-wrapper{margin:4px 0;overflow-x:auto;}.console-table{border-collapse:collapse;font-size:11px;min-width:200px;background:var(--bg-primary);}.console-table th,.console-table td{border:1px solid var(--table-border);padding:4px 8px;text-align:left;}.console-table th{background:var(--table-header-bg);font-weight:bold;color:var(--text-primary);position:sticky;top:0;}.console-table tr:hover{background:var(--table-row-hover);}.console-table .table-index{color:var(--text-secondary);font-weight:bold;}.console-logs::-webkit-scrollbar{width:10px;}.console-logs::-webkit-scrollbar-track{background:var(--scrollbar-track);}.console-logs::-webkit-scrollbar-thumb{background:var(--scrollbar-thumb);border-radius:5px;}.console-logs::-webkit-scrollbar-thumb:hover{background:var(--scrollbar-thumb-hover);}`;}}customElements.define('browser-console',BrowserConsole);export{BrowserConsole};export default BrowserConsole;